
# ==================================================================================
# PostgreSQL HA (Patroni) Configuration
# ==================================================================================

# PostgreSQL Ports
POSTGRES_PORT=5432                  # Primary PostgreSQL port
POSTGRES_PORT_REPLICA=5433          # Replica PostgreSQL port
PGBOUNCER_PORT=6432                 # PgBouncer connection pooler port

# PostgreSQL Basic Configuration
POSTGRES_DB=postgres
POSTGRES_USER=shudl
SHUDL_DB=shudl
NESSIE_DB=nessie

# Patroni API Configuration
PATRONI_API_PASSWORD=patroni_secure_password_$(openssl rand -hex 12)

# PostgreSQL Rewind User (for pg_rewind during failover)
POSTGRESQL_REWIND_PASSWORD=rewind_secure_password_$(openssl rand -hex 12)

# etcd Configuration
ETCD_CLUSTER_TOKEN=etcd-cluster-shudl

# PgBouncer Configuration
PGBOUNCER_POOL_MODE=transaction
PGBOUNCER_MAX_CLIENT_CONN=1000
PGBOUNCER_DEFAULT_POOL_SIZE=25
PGBOUNCER_RESERVE_POOL_SIZE=5
PGBOUNCER_MAX_DB_CONNECTIONS=100

# Notes:
# - Passwords for postgres, shudl, and replicator users are stored in Docker Secrets
# - See secrets/passwords/ directory for secret files
# - etcd cluster runs with 3 nodes for quorum (etcd-1, etcd-2, etcd-3)
# - Patroni manages automatic failover between postgresql-patroni-1 and postgresql-patroni-2
# - PgBouncer provides connection pooling in front of PostgreSQL nodes

